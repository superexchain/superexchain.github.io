import{_ as s,o as n,c as a,O as l}from"./chunks/framework.62a149d4.js";const F=JSON.parse('{"title":"SIP-721 標準","description":"","frontmatter":{},"headers":[],"relativePath":"zh-tw/smart-contract/standard/SIP-721.md","filePath":"zh-tw/smart-contract/standard/SIP-721.md"}'),o={name:"zh-tw/smart-contract/standard/SIP-721.md"},t=l(`<h1 id="sip-721-標準" tabindex="-1">SIP-721 標準 <a class="header-anchor" href="#sip-721-標準" aria-label="Permalink to &quot;SIP-721 標準&quot;">​</a></h1><h2 id="簡要說明" tabindex="-1">簡要說明 <a class="header-anchor" href="#簡要說明" aria-label="Permalink to &quot;簡要說明&quot;">​</a></h2><p>非同質化代幣（Non-Fungible Token，以下簡稱 NFT 或 NFTs）的標準介面。</p><h2 id="摘要" tabindex="-1">摘要 <a class="header-anchor" href="#摘要" aria-label="Permalink to &quot;摘要&quot;">​</a></h2><p>提案描述了在智能合約中實現 NFT 的標準API。該標準提供了追踪和轉移 NFT 的基本功能。</p><p>提案考慮了個人擁有和交易 NFT 的場景，以及委託給第三方（如：代理人/錢包/拍賣人，稱為 &quot;操作者&quot;）的情況。</p><p>NFT 可以代表對數字或實物資產的所有權。我們考慮了資產的多樣性，並且我們知道您會想要代表更多：</p><ul><li>實體財產 - 如：房屋，獨特的藝術品</li><li>虛擬收藏品 - 如：小貓，收藏卡的獨特圖片</li><li>&quot;負&quot; 資產 - 如：貸款等</li></ul><p>總的來說，所有房屋都是不同的，沒有兩只小貓是一樣的。NFT 是可區分的，必須分別追踪每個所有者。</p><h2 id="動機" tabindex="-1">動機 <a class="header-anchor" href="#動機" aria-label="Permalink to &quot;動機&quot;">​</a></h2><p>標準介面可以方便錢包/代理/拍賣應用與以太坊上的任何 NFT 進行交互。提供簡單的 ERC-721 智能合約以及追踪數量眾多 NFT 的合約。其他應用將在下面討論。</p><p>該標準的靈感來自 ERC20 代幣標準，並建立自 EIP-20 創建以來的兩年經驗。ERC20 無法追踪 NFT，因為每種資產都是不同的（不可替代的），而 ERC20 每個代幣的數量都是相同的（可替代的）。</p><p>該標準與 ERC20 之間的差異在下面進行說明。</p><h2 id="規範" tabindex="-1">規範 <a class="header-anchor" href="#規範" aria-label="Permalink to &quot;規範&quot;">​</a></h2><p>**每個符合 ERC-721 的合約都必須實現 <code>ERC721</code> 和 <code>ERC165</code> 介面（受以下「說明」約束）：</p><div class="language-solidity"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">pragma</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">solidity</span><span style="color:#A6ACCD;"> ^0.4.20</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@title</span><span style="color:#676E95;font-style:italic;"> ERC-721非同质化代币标准</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> 參考 https://learnblockchain.cn/docs/eips/eip-721.html</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">///  注意：ERC-165 接口id為 0x80ac58cd。</span></span>
<span class="line"><span style="color:#C792EA;">interface</span><span style="color:#FFCB6B;"> ERC721</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">/* is ERC165 */</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> 當任何NFT的所有權更改時（不管哪種方式），就會觸發此事件。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">///  包括在創建時（\`from\` == 0）和銷毀時(\`to\` == 0)，合約創建時除外。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">event</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Transfer</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">indexed</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_from</span><span style="color:#A6ACCD;">, </span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">indexed</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_to</span><span style="color:#A6ACCD;">, </span><span style="color:#FFCB6B;">uint256</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">indexed</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_tokenId</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> 當更改或確認NFT的授權地址時觸發。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">///  零地址表示沒有授權的地址。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">///  發生 \`Transfer\` 事件時，同樣表示該NFT的授權地址（如果有）被重置為“無”（零地址）。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">event</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Approval</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">indexed</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_owner</span><span style="color:#A6ACCD;">, </span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">indexed</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_approved</span><span style="color:#A6ACCD;">, </span><span style="color:#FFCB6B;">uint256</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">indexed</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_tokenId</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> 所有者啟用或禁用操作員時觸發。（操作員可管理所有者所持有的NFTs）</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">event</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ApprovalForAll</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">indexed</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_owner</span><span style="color:#A6ACCD;">, </span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">indexed</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_operator</span><span style="color:#A6ACCD;">, </span><span style="color:#FFCB6B;">bool</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_approved</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@notice</span><span style="color:#676E95;font-style:italic;"> 統計所持有的NFTs數量</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> NFT 不能分配給零地址，查詢零地址同樣會拋出異常</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_owner</span><span style="color:#676E95;font-style:italic;"> ： 待查地址</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@return</span><span style="color:#676E95;font-style:italic;"> 返回數量，也許是0</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">balanceOf</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_owner</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">external</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">view</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">returns</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">uint256</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@notice</span><span style="color:#676E95;font-style:italic;"> 返回所有者</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> NFT 不能分配給零地址，查詢零地址拋出異常</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_tokenId</span><span style="color:#676E95;font-style:italic;"> NFT 的id</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@return</span><span style="color:#676E95;font-style:italic;"> 返回所有者地址</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ownerOf</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">uint256</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_tokenId</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">external</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">view</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">returns</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">address</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@notice</span><span style="color:#676E95;font-style:italic;"> 將NFT的所有權從一個地址轉移到另一個地址</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> 如果\`msg.sender\` 不是當前的所有者（或授權者）拋出異常</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// 如果 \`_from\` 不是所有者、\`_to\` 是零地址、\`_tokenId\` 不是有效id 均拋出異常。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">///  當轉移完成時，函數檢查  \`_to\` 是否是合約，如果是，調用 \`_to\`的 \`onERC721Received\` 並且檢查返回值是否是 \`0x150b7a02\`（即：\`bytes4(keccak256(&quot;onERC721Received(address,address,uint256,bytes)&quot;))\`）  如果不是拋出異常。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_from</span><span style="color:#676E95;font-style:italic;"> ：當前的所有者</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_to</span><span style="color:#676E95;font-style:italic;"> ：新的所有者</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_tokenId</span><span style="color:#676E95;font-style:italic;"> ：要轉移的token id.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">data</span><span style="color:#676E95;font-style:italic;"> 其他參數</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">safeTransferFrom</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_from</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_to</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">uint256</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_tokenId</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">bytes</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">data</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">external</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">payable</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@notice</span><span style="color:#676E95;font-style:italic;"> 將NFT的所有權從一個地址轉移到另一個地址</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> 當轉移完成時，函數檢查 \`_to\` 是否是合約，如果是，調用 \`_to\`的 \`onERC721Received\` 並且檢查返回值是否是 \`0x150b7a02\`（即：\`bytes4(keccak256(&quot;onERC721Received(address,address,uint256,bytes)&quot;))\`）  如果不是拋出異常。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">///  當轉移完成時，發出一個 \`Transfer\` 事件。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_from</span><span style="color:#676E95;font-style:italic;"> ：當前的所有者</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_to</span><span style="color:#676E95;font-style:italic;"> ：新的所有者</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_tokenId</span><span style="color:#676E95;font-style:italic;"> ：要轉移的token id.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">safeTransferFrom</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_from</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_to</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">uint256</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_tokenId</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">external</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">payable</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@notice</span><span style="color:#676E95;font-style:italic;"> 將NFT的所有權從一個地址轉移到另一個地址</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> 如果\`msg.sender\` 不是當前的所有者（或授權者）拋出異常</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// 如果 \`_from\` 不是所有者、\`_to\` 是零地址、\`_tokenId\` 不是有效id 均拋出異常。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_from</span><span style="color:#676E95;font-style:italic;"> ：當前的所有者</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_to</span><span style="color:#676E95;font-style:italic;"> ：新的所有者</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_tokenId</span><span style="color:#676E95;font-style:italic;"> ：要轉移的token id.</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">transferFrom</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_from</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_to</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">uint256</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_tokenId</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">external</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">payable</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@notice</span><span style="color:#676E95;font-style:italic;"> 批准地址的NFT，這個地址可以操作所有的NFT。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> 在\`Approval\`事件觸發之前，合約必須允許所有者通過\`ownerOf\`函數查詢NFT。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_approved</span><span style="color:#676E95;font-style:italic;"> ：權限被授權給的地址。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_tokenId</span><span style="color:#676E95;font-style:italic;"> ：NFT的id。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">approve</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_approved</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">uint256</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_tokenId</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">external</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">payable</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@notice</span><span style="color:#676E95;font-style:italic;"> 批准或撤銷對另一個地址的授權操作。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> 實現合約必須要檢查 \`operator\` 是否能操作所有者 \`_owner\` 所持有的NFT。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_operator</span><span style="color:#676E95;font-style:italic;"> ： 操作者的地址。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_approved</span><span style="color:#676E95;font-style:italic;"> ： 是否批准操作者。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">setApprovalForAll</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_operator</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">bool</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_approved</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">external</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@notice</span><span style="color:#676E95;font-style:italic;"> 獲取操作者對所有者地址的授權狀態。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_owner</span><span style="color:#676E95;font-style:italic;"> ： 所有者的地址。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_operator</span><span style="color:#676E95;font-style:italic;"> ： 操作者的地址。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@return</span><span style="color:#676E95;font-style:italic;"> 返回真，如果操作者被授權操作所有者地址的NFT。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">isApprovedForAll</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_owner</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_operator</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">external</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">view</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">returns</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">bool</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">interface</span><span style="color:#FFCB6B;"> ERC165</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@notice</span><span style="color:#676E95;font-style:italic;"> 判斷合約是否實現了接口</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">interfaceID</span><span style="color:#676E95;font-style:italic;"> ERC-165 定義的接口 ID</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> 函數執行需要少於 30,000 gas。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@return</span><span style="color:#676E95;font-style:italic;"> 如果合約實現了 interfaceID（不等於 0xffffffff），則返回 true，否則返回 false。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">supportsInterface</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">bytes4</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">interfaceID</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">external</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">view</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">returns</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">bool</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>如果合約（應用）要接受NFT的安全轉賬，則必須實現<strong>以下接口</strong>。</p><div class="language-solidity"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> 根據 ERC-165 標準，介面 ID 為 0x150b7a02。</span></span>
<span class="line"><span style="color:#C792EA;">interface</span><span style="color:#FFCB6B;"> ERC721TokenReceiver</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@notice</span><span style="color:#676E95;font-style:italic;"> 處理接收NFT</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> 在 ERC721 智能合約的 \`transfer\` 函數完成後，在接收地址上調用此函數。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// 函數可以通過 revert 拒絕接收。返回非 \`0x150b7a02\` 也是拒絕接收。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// 注意：調用此函數的 \`msg.sender\` 是 ERC721 的合約地址。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_operator</span><span style="color:#676E95;font-style:italic;">：調用 \`safeTransferFrom\` 函數的地址。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_from</span><span style="color:#676E95;font-style:italic;">：之前的NFT擁有者。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_tokenId</span><span style="color:#676E95;font-style:italic;">：NFT token ID。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_data</span><span style="color:#676E95;font-style:italic;">：附加數據。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@return</span><span style="color:#676E95;font-style:italic;"> 正確處理時返回 \`bytes4(keccak256(&quot;onERC721Received(address,address,uint256,bytes)&quot;))\`</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onERC721Received</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_operator</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_from</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">uint256</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_tokenId</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">bytes</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_data</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">external</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">returns</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">bytes4</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>以下元信息擴展是可選的（查看後面的 &quot;說明&quot; 部分），但可以提供一些資產代表的信息以便查詢。</p><div class="language-solidity"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@title</span><span style="color:#676E95;font-style:italic;"> ERC-721非同質化代幣標準，可選元信息擴展</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> 參考 https://learnblockchain.cn/docs/eips/eip-721.html</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">///  注意：根據 ERC-165 標準，介面 ID 為 0x5b5e139f。</span></span>
<span class="line"><span style="color:#C792EA;">interface</span><span style="color:#FFCB6B;"> ERC721Metadata</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">/* is ERC721 */</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@notice</span><span style="color:#676E95;font-style:italic;"> NFTs 集合的名稱</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">name</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">external</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">view</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">returns</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_name</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@notice</span><span style="color:#676E95;font-style:italic;"> NFTs 縮寫代號</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">symbol</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">external</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">view</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">returns</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">string</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_symbol</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@notice</span><span style="color:#676E95;font-style:italic;"> 一個給定資產的唯一統一資源標識符（URI）</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> 如果 \`_tokenId\` 無效，拋出異常。URIs 在 RFC 3986 定義，</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// URI 也許指向一個符合 &quot;ERC721 元數據 JSON Schema&quot; 的 JSON 文件。</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">tokenURI</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">uint256</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_tokenId</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">external</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">view</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">returns</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">string</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>以下是 &quot;ERC721 元數據 JSON Schema&quot; 的描述：</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">title</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Asset Metadata</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">object</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">properties</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">string</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">指示NFT代表什麼</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">string</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">描述NFT 代表的資產</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">image</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">type</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">string</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">description</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">指向NFT表示資產的資源的URI（MIME 類型為 image/*） ， 可以考慮寬度在320到1080像素之間，寬高比在1.91:1到4:5之間的圖像。</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>以下枚舉擴展信息是可選的（查看後面的 &quot;說明&quot; 部分），但可以提供NFTs的完整列表，以便NFT可被發現。</p><div class="language-solidity"><button title="Copy Code" class="copy"></button><span class="lang">solidity</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@title</span><span style="color:#676E95;font-style:italic;"> ERC-721非同質化代幣標準枚舉擴展信息</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> 參考 https://learnblockchain.cn/docs/eips/eip-721.html</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">///  注意：根據 ERC-165 標準，介面 ID 為 0x780e9d63。</span></span>
<span class="line"><span style="color:#C792EA;">interface</span><span style="color:#FFCB6B;"> ERC721Enumerable</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">/* is ERC721 */</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@notice</span><span style="color:#676E95;font-style:italic;">  NFTs 計數</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@return</span><span style="color:#676E95;font-style:italic;">  返回合約有效跟踪（所有者不為零地址）的 NFT 數量</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">totalSupply</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">external</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">view</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">returns</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">uint256</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@notice</span><span style="color:#676E95;font-style:italic;"> 枚舉索引NFT</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;"> 如果 \`_index\` &gt;= \`totalSupply()\` 則拋出異常</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_index</span><span style="color:#676E95;font-style:italic;"> 小於 \`totalSupply()\` 的索引號</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@return</span><span style="color:#676E95;font-style:italic;"> 對應的 token id（標準不指定排序方式)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">tokenByIndex</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">uint256</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_index</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">external</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">view</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">returns</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">uint256</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@notice</span><span style="color:#676E95;font-style:italic;"> 枚舉索引某個所有者的 NFTs</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@dev</span><span style="color:#676E95;font-style:italic;">  如果 \`_index\` &gt;= \`balanceOf(_owner)\` 或 \`_owner\` 是零地址，拋出異常</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_owner</span><span style="color:#676E95;font-style:italic;"> 查詢的所有者地址</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@param</span><span style="color:#676E95;font-style:italic;"> </span><span style="color:#A6ACCD;font-style:italic;">_index</span><span style="color:#676E95;font-style:italic;"> 小於 \`balanceOf(_owner)\` 的索引號</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/// </span><span style="color:#C792EA;font-style:italic;">@return</span><span style="color:#676E95;font-style:italic;"> 對應的 token id （標準不指定排序方式)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">tokenOfOwnerByIndex</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">address</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_owner</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">uint256</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">_index</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">external</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">view</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">returns</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">uint256</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h3 id="說明" tabindex="-1">說明 <a class="header-anchor" href="#說明" aria-label="Permalink to &quot;說明&quot;">​</a></h3><p>Solidity 0.4.20 介面語法不足以表達 ERC-721 標準文件，ERC-721 標準的合約還必須遵守以下規則：</p><ul><li><p>Solidity issue #3412：上述介面中的每個函數都包含明確的可變性聲明。可變性聲明按照從弱到強的順序為：payable（可支付），隱含的不可支付，view（視圖）和 pure（純函數）。實現必須符合此介面中的可變性聲明，或者使用更強的可變性聲明。例如，介面中的 payable 函數可以在合約中實現為不可支付（即未指定）。</p></li><li><p>Solidity issue #3419：同時實現 ERC721Metadata 和 ERC721Enumerable 介面也需要實現 ERC721，ERC-721 要求實現 ERC-165 介面。</p></li><li><p>Solidity issue #2330：標記為 external 的函數也可以使用 public 可見性。</p></li></ul><h2 id="原理闡述" tabindex="-1">原理闡述 <a class="header-anchor" href="#原理闡述" aria-label="Permalink to &quot;原理闡述&quot;">​</a></h2><p>許多智能合約提案依賴於追蹤可區分的資產，例如 Decentraland 的 LAND、CryptoPunk 中的獨特人物，以及使用 DMarket 或 EnjinCoin 等系統的遊戲內物品。未來的應用包括追蹤現實世界的資產，例如房地產（如Ubitquity或Propy等公司所設想的）。在這些情況下，這些項目不能像數字資產一樣集中於一個賬本中，而是每個資產都必須單獨且原子地追蹤所有權。無論資產的性質如何，如果擁有一個標準化接口，允許跨行業的資產管理和交易平台，那麼生態系統將變得更加強大。</p><p><strong>&quot;NFT&quot; 詞的選擇</strong></p><p>&quot;NFT&quot; 幾乎是所有受調查者都滿意的詞，並且廣泛應用於可區分的數字資產領域。</p><p><em>考慮的替代方案：可區分的資產、所有權、代幣（通證）、資產、權益、票據</em></p><p><strong>NFT 身份識別號碼</strong></p><p>每個NFT都由ERC-721智能合約內部的唯一<code>uint256 ID</code>識別。該識別碼在整個協議期間不得更改。(合約地址，<code>tokenId</code>)對將成為以太坊區塊鏈上特定資產的全球唯一且完全合格的標識符。儘管某些ERC-721智能合約可能方便地以ID為0開始並為每個新的NFT加1，但呼叫者不得假設ID號具有任何特定的模式，並且必須將ID視為黑盒。另請注意，NFT可能會變得無效（被銷毀）。請參閱支持的列舉接口的列舉功能。</p><p>由於UUID和sha3哈希可以直接轉換為<code>uint256</code>，因此使用<code>uint256</code>可以實現更廣泛的應用。</p><p><strong>代幣轉移（或稱轉賬）</strong></p><p>ERC-721標準有兩個轉移函數<code>safeTransferFrom</code>（重載了帶data和不帶data參數的兩種形式）及<code>transferFrom</code>，轉移可以由以下角色發起：</p><ul><li>NFT的所有者</li><li>NFT的被授權（approved）地址</li><li>NFT當前所有者授權的（authorized）操作員</li></ul><p>此外，授權的操作員也可以為NFT設置授權（approved）地址，這可以為錢包、經紀人和拍賣應用提供一套強大的工具，方便快速使用大量的NFT。</p><p>轉移方法僅列出了特定條件下需要拋出異常的情況，我們自己的實現也可以在其他情況下拋出異常，這可以實現一些有趣效果：</p><ul><li><strong>如果合約暫停，可以禁用轉賬</strong>，如CryptoKitties合約（611行）</li><li><strong>將接收NFT的某些地址列入黑名單</strong>，如CryptoKitties合約（565, 566行）</li><li><strong>禁用非安全的轉賬</strong>，除非<code>_to</code>為<code>msg.sender</code>或<code>countOf(_to)</code>為非零或之前是非零（這些情況是安全的），否則<code>transferFrom</code>拋出異常。</li><li><strong>向交易雙方收取費用</strong>，從零地址向非零地址授權（<code>approve</code>）可以要求支付費用，還原到（<code>approve</code>）零地址時退款；調用任何<code>transfer</code>時要求支付費用；要求<code>transfer</code>參數<code>_to</code>等於<code>msg.sender</code>；要求<code>transfer</code>參數<code>_to</code>是NFT授權（<code>approved</code>）的地址</li><li><strong>僅讀的NFT註冊表</strong>，使用函數<code>unsafeTransfer</code>、<code>transferFrom</code>、<code>approve</code>以及<code>setApprovalForAll</code>時都拋出異常。异常。</li></ul>`,41),p=[t];function e(c,y,r,i,C,A){return n(),a("div",null,p)}const f=s(o,[["render",e]]);export{F as __pageData,f as default};
